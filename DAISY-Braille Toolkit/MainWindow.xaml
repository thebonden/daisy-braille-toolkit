<Window x:Class="DAISY_Braille_Toolkit.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="DAISY-Braille Toolkit" Height="880" Width="1240"
        Icon="Assets/DaisyBrailleToolkit.ico"
        Loaded="Window_Loaded">
    <DockPanel Margin="0">

        <!-- Top menu -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="{DynamicResource Menu_File}">
                <MenuItem Header="{DynamicResource Menu_File_SelectJobFolder}" Click="BrowseJobFolder_Click"/>
                <MenuItem Header="{DynamicResource Menu_File_SelectSourceFile}" Click="BrowseSourceFile_Click"/>
                <Separator/>
                <MenuItem Header="{DynamicResource Menu_File_OpenJobFolder}" Click="OpenJobFolder_Click"/>
                <Separator/>
                <MenuItem Header="{DynamicResource Menu_File_Exit}" Click="Exit_Click"/>
            </MenuItem>

            <MenuItem Header="{DynamicResource Menu_Tools}">
                <MenuItem Header="{DynamicResource Menu_Tools_RefreshVoices}" Click="RefreshVoices_Click"/>
                <Separator/>
                <MenuItem Header="{DynamicResource Menu_Tools_CopyLog}" Click="CopyLog_Click"/>
                <MenuItem Header="{DynamicResource Menu_Tools_ClearLog}" Click="ClearLog_Click"/>
            </MenuItem>

            <MenuItem Header="{DynamicResource Menu_Language}">
                <MenuItem x:Name="LangEnglishMenu" Header="{DynamicResource Menu_Language_English}" IsCheckable="True" Click="SetEnglish_Click"/>
                <MenuItem x:Name="LangDanishMenu" Header="{DynamicResource Menu_Language_Danish}" IsCheckable="True" Click="SetDanish_Click"/>
            </MenuItem>

            <MenuItem Header="{DynamicResource Menu_Help}">
                <MenuItem Header="{DynamicResource Menu_Help_About}" Click="About_Click"/>
            </MenuItem>
        </Menu>

        <!-- Header (logo + title) -->
        <Border DockPanel.Dock="Top" Background="#F5F5F5" Padding="10" BorderBrush="#DDDDDD" BorderThickness="0,0,0,1">
            <DockPanel>
                <Image Source="Assets/logo-mark.png" Height="42" Stretch="Uniform" Margin="0,0,10,0"/>
                <StackPanel>
                    <TextBlock Text="DAISY-Braille Toolkit" FontSize="22" FontWeight="SemiBold"/>
                    <TextBlock Text="{DynamicResource Header_Subtitle}" Opacity="0.75"/>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- Tabs -->
        <TabControl x:Name="MainTabs" Margin="12">
            <!-- Run job -->
            <TabItem Header="{DynamicResource Tab_RunJob}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <GroupBox Header="{DynamicResource Gb_RunPipeline}" Padding="10" Margin="0,0,0,10">
                            <TextBlock Text="{DynamicResource Txt_RunPipeline_Next}" TextWrapping="Wrap"/>
                        </GroupBox>

                        <GroupBox Header="{DynamicResource Gb_JobSelection}" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="170"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Text="{DynamicResource Lbl_JobFolder}"/>
                                <TextBox Grid.Row="0" Grid.Column="1" x:Name="JobFolderBox" Margin="0,0,10,0"/>
                                <Button Grid.Row="0" Grid.Column="2" Width="140" Content="{DynamicResource Btn_SelectFolder}" Click="BrowseJobFolder_Click"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Text="{DynamicResource Lbl_SourceFile}"/>
                                <TextBox Grid.Row="1" Grid.Column="1" x:Name="SourceFileBox" Margin="0,0,10,0"/>
                                <Button Grid.Row="1" Grid.Column="2" Width="140" Content="{DynamicResource Btn_SelectFile}" Click="BrowseSourceFile_Click"/>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- TTS -->
            <TabItem Header="{DynamicResource Tab_TTS}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <GroupBox Header="{DynamicResource Gb_TtsEditor}" Padding="10" Margin="0,0,0,10">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Actions -->
                                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                    <Button Width="160" Content="{DynamicResource Btn_BuildSegments}" Click="BuildSegments_Click"/>
                                    <Button Width="180" Margin="10,0,0,0" Content="{DynamicResource Btn_CopySelected}" Click="CopySourceToTts_Selected_Click"/>
                                    <Button Width="190" Margin="10,0,0,0" Content="{DynamicResource Btn_CopyAll}" Click="CopySourceToTts_All_Click"/>
                                    <Button Width="150" Margin="10,0,0,0" Content="{DynamicResource Btn_SaveSelected}" Click="SaveTts_Selected_Click"/>
                                    <Button Width="150" Margin="10,0,0,0" Content="{DynamicResource Btn_SaveAll}" Click="SaveTts_All_Click"/>
                                    <Button Width="190" Margin="10,0,0,0" Content="{DynamicResource Btn_DanishFixes}" Click="ApplyDanishFixes_Click"/>
                                    <TextBlock x:Name="SegmentsStatusText" Margin="12,0,0,0" VerticalAlignment="Center"/>
                                </StackPanel>

                                <Grid Grid.Row="1" Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="280"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="{DynamicResource Lbl_Segments}" FontWeight="SemiBold"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{DynamicResource Lbl_Source}" FontWeight="SemiBold"/>
                                    <TextBlock Grid.Row="0" Grid.Column="2" Text="{DynamicResource Lbl_Tts}" FontWeight="SemiBold"/>

                                    <ListBox Grid.Row="1" Grid.Column="0" x:Name="SegmentsList" SelectionChanged="SegmentsList_SelectionChanged"/>

                                    <TextBox Grid.Row="1" Grid.Column="1" x:Name="SourceTextBox" Margin="8,0,8,0"
                                             IsReadOnly="True" VerticalScrollBarVisibility="Auto" TextWrapping="Wrap"/>

                                    <TextBox Grid.Row="1" Grid.Column="2" x:Name="TtsTextBox"
                                             VerticalScrollBarVisibility="Auto" TextWrapping="Wrap" AcceptsReturn="True"/>

                                    <!-- Tag buttons -->
                                    <WrapPanel Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" Margin="0,8,0,0">
                                        <TextBlock Text="{DynamicResource Lbl_InsertTags}" VerticalAlignment="Center" Margin="0,0,10,0"/>

                                        <Button Content="[pause]" Margin="0,0,6,0" Click="InsertTag_Click"/>
                                        <Button Content="[short pause]" Margin="0,0,6,0" Click="InsertTag_Click"/>
                                        <Button Content="[long pause]" Margin="0,0,12,0" Click="InsertTag_Click"/>

                                        <Button Content="[sarcastic]" Margin="0,0,6,0" Click="InsertTag_Click"/>
                                        <Button Content="[curious]" Margin="0,0,6,0" Click="InsertTag_Click"/>
                                        <Button Content="[excited]" Margin="0,0,6,0" Click="InsertTag_Click"/>
                                        <Button Content="[crying]" Margin="0,0,6,0" Click="InsertTag_Click"/>
                                        <Button Content="[mischievously]" Margin="0,0,12,0" Click="InsertTag_Click"/>

                                        <Button Content="[whispers]" Margin="0,0,6,0" Click="InsertTag_Click"/>
                                        <Button Content="[shouts]" Margin="0,0,12,0" Click="InsertTag_Click"/>

                                        <Button Content="[laughs]" Margin="0,0,6,0" Click="InsertTag_Click"/>
                                        <Button Content="[sighs]" Margin="0,0,6,0" Click="InsertTag_Click"/>
                                        <Button Content="[exhales]" Margin="0,0,6,0" Click="InsertTag_Click"/>
                                        <Button Content="[clears throat]" Margin="0,0,6,0" Click="InsertTag_Click"/>
                                    </WrapPanel>
                                </Grid>

                                <!-- Note -->
                                <TextBlock Grid.Row="2" Opacity="0.75" TextWrapping="Wrap" Text="{DynamicResource Txt_Tip_SegmentsUsesJob}"/>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Voices -->
            <TabItem Header="{DynamicResource Tab_Voices}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <GroupBox Header="{DynamicResource Gb_VoiceSelection}" Padding="10" Margin="0,0,0,10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="170"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="170"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Text="{DynamicResource Lbl_DefaultModel}"/>
                                <ComboBox Grid.Row="0" Grid.Column="1" x:Name="ModelCombo" MinWidth="260"/>

                                <TextBlock Grid.Row="0" Grid.Column="2" VerticalAlignment="Center" Text="{DynamicResource Lbl_LanguageFilter}" Margin="10,0,0,0"/>
                                <ComboBox Grid.Row="0" Grid.Column="3" x:Name="LanguageFilterCombo" MinWidth="260"
                                          SelectionChanged="LanguageFilterCombo_SelectionChanged"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Text="{DynamicResource Lbl_DefaultVoice}"/>
                                <ComboBox Grid.Row="1" Grid.Column="1" x:Name="VoiceCombo" MinWidth="260"
                                          DisplayMemberPath="DisplayName" SelectedValuePath="VoiceId"
                                          SelectionChanged="VoiceCombo_SelectionChanged"/>

                                <TextBlock Grid.Row="1" Grid.Column="2" VerticalAlignment="Center" Text="{DynamicResource Lbl_VoiceDetails}" Margin="10,0,0,0"/>
                                <TextBlock Grid.Row="1" Grid.Column="3" x:Name="VoiceDetailsText" TextWrapping="Wrap" />

                                <TextBlock Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Text="{DynamicResource Lbl_VoiceList}"/>
                                <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal">
                                    <Button Width="160" Content="{DynamicResource Btn_UpdateVoiceList}" Click="RefreshVoices_Click"/>
                                    <TextBlock x:Name="VoicesSyncText" Margin="12,0,0,0" VerticalAlignment="Center"/>
                                </StackPanel>

                                <TextBlock Grid.Row="2" Grid.Column="2" VerticalAlignment="Center" Text="{DynamicResource Lbl_Preview}" Margin="10,0,0,0"/>
                                <StackPanel Grid.Row="2" Grid.Column="3" Orientation="Horizontal">
                                    <Button Width="140" Content="{DynamicResource Btn_PlayPreview}" Click="PlayPreview_Click"/>
                                    <Button Width="140" Margin="10,0,0,0" Content="{DynamicResource Btn_Stop}" Click="StopPreview_Click"/>
                                    <TextBlock x:Name="PreviewStatusText" Margin="12,0,0,0" VerticalAlignment="Center"/>
                                </StackPanel>

                                <TextBlock Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Text="{DynamicResource Lbl_Cleanup}"/>
                                <CheckBox Grid.Row="3" Grid.Column="1" x:Name="CleanupCheck"
                                          Content="{DynamicResource Chk_Cleanup}"/>

                                <StackPanel Grid.Row="3" Grid.Column="2" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="10,0,0,0">
                                    <Button Width="160" Content="{DynamicResource Btn_SaveSettings}" Click="SaveSettings_Click"/>
                                    <TextBlock x:Name="SettingsSavedText" Margin="12,0,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>

                        <TextBlock Opacity="0.75" TextWrapping="Wrap" Text="{DynamicResource Txt_Voices_Explain}"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Settings -->
            <TabItem Header="{DynamicResource Tab_Settings}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <GroupBox Header="{DynamicResource Gb_ElevenLabsApi}" Padding="10" Margin="0,0,0,10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="170"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Text="{DynamicResource Lbl_ApiKey}"/>
                                <PasswordBox Grid.Row="0" Grid.Column="1" x:Name="ApiKeyBox" Margin="0,0,10,0"/>

                                <Button Grid.Row="0" Grid.Column="2" Width="120" Margin="0,0,10,0"
                                        Content="{DynamicResource Btn_SaveApiKey}" Click="SaveApiKey_Click"/>
                                <Button Grid.Row="0" Grid.Column="3" Width="120"
                                        Content="{DynamicResource Btn_DeleteApiKey}" Click="DeleteApiKey_Click"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Text="{DynamicResource Lbl_Status}"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" x:Name="ApiKeyStatusText" VerticalAlignment="Center"/>
                            </Grid>
                        </GroupBox>

                        <GroupBox Header="{DynamicResource Gb_Notes}" Padding="10">
                            <TextBlock TextWrapping="Wrap" Text="{DynamicResource Txt_Notes_Api}"/>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Production data -->
            <TabItem Header="{DynamicResource Tab_ProductionData}" Loaded="ProductionTab_Loaded">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <GroupBox Header="{DynamicResource Gb_ProductionData}" Padding="10" Margin="0,0,0,10">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"
                                       Text="{DynamicResource Prod_CsvFile}"/>
                            <TextBox Grid.Row="0" Grid.Column="1" MinWidth="260" Margin="0,0,10,0" x:Name="ProductionCsvPathBox"/>
                            <Button Grid.Row="0" Grid.Column="2" Margin="0,0,10,0" MinWidth="120"
                                    Content="{DynamicResource Btn_SelectFile}" Click="Production_BrowseCsv_Click"/>
                            <Button Grid.Row="0" Grid.Column="3" MinWidth="120"
                                    Content="{DynamicResource Btn_ExportCsv}" Click="Production_ExportCsv_Click"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,8,0,0" TextWrapping="Wrap"
                                       Text="{DynamicResource Prod_Help}"/>
                        </Grid>
                    </GroupBox>

                    <DataGrid Grid.Row="1" x:Name="ProductionGrid" AutoGenerateColumns="False"
                              CanUserAddRows="True" CanUserDeleteRows="True" SelectionMode="Single"
                              HeadersVisibility="Column" IsReadOnly="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="{DynamicResource Prod_Col_Date}" Binding="{Binding Timestamp}" Width="160"/>
                            <DataGridTextColumn Header="{DynamicResource Prod_Col_Title}" Binding="{Binding Title}" Width="*"/>
                            <DataGridTextColumn Header="{DynamicResource Prod_Col_Language}" Binding="{Binding Language}" Width="120"/>
                            <DataGridTextColumn Header="{DynamicResource Prod_Col_Model}" Binding="{Binding ModelId}" Width="160"/>
                            <DataGridTextColumn Header="{DynamicResource Prod_Col_Voice}" Binding="{Binding VoiceName}" Width="200"/>
                            <DataGridTextColumn Header="{DynamicResource Prod_Col_VoiceId}" Binding="{Binding VoiceId}" Width="200"/>
                            <DataGridTextColumn Header="{DynamicResource Prod_Col_Source}" Binding="{Binding SourceFile}" Width="240"/>
                            <DataGridTextColumn Header="{DynamicResource Prod_Col_JobFolder}" Binding="{Binding JobFolder}" Width="240"/>
                            <DataGridTextColumn Header="{DynamicResource Prod_Col_Notes}" Binding="{Binding Notes}" Width="240"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <Button MinWidth="160" Margin="0,0,10,0" Content="{DynamicResource Btn_AddFromCurrentJob}"
                                Click="Production_AddCurrentJob_Click"/>
                        <Button MinWidth="160" Margin="0,0,10,0" Content="{DynamicResource Btn_RemoveSelected}"
                                Click="Production_RemoveSelected_Click"/>
                        <Button MinWidth="160" Margin="0,0,10,0" Content="{DynamicResource Btn_CopySelectedRow}"
                                Click="Production_CopySelected_Click"/>
                        <Button MinWidth="160" Content="{DynamicResource Btn_OpenFolder}"
                                Click="Production_OpenFolder_Click"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Log -->
            <TabItem Header="{DynamicResource Tab_Log}">
                <DockPanel LastChildFill="True">
                    <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,8">
                        <Button Width="140" Content="{DynamicResource Btn_CopyLog}" Click="CopyLog_Click"/>
                        <Button Width="140" Margin="10,0,0,0" Content="{DynamicResource Btn_ClearLog}" Click="ClearLog_Click"/>
                    </StackPanel>

                    <TextBox x:Name="LogText"
                             VerticalScrollBarVisibility="Auto"
                             HorizontalScrollBarVisibility="Auto"
                             IsReadOnly="True"
                             TextWrapping="NoWrap"/>
                </DockPanel>
            </TabItem>
        </TabControl>

    </DockPanel>
</Window>
